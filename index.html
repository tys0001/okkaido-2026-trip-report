<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>北海道冬之親子大縱走｜旅遊手冊</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Print-friendly */
    @media print {
      .no-print { display: none !important; }
      .print-block { break-inside: avoid; }
      body { background: white !important; }
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-900">
  <header class="no-print sticky top-0 z-20 border-b bg-white/90 backdrop-blur">
    <div class="mx-auto max-w-6xl px-4 py-3 flex items-center gap-3">
      <div class="flex-1">
        <div class="text-lg font-semibold">北海道冬之親子大縱走｜旅遊手冊</div>
        <div class="text-sm text-slate-600">2026/01/30（五）– 2026/02/04（三）</div>
      </div>
      <button id="btnPrint" class="rounded-xl border px-3 py-2 text-sm hover:bg-slate-50">列印</button>
      <button id="btnReset" class="rounded-xl border px-3 py-2 text-sm hover:bg-slate-50">重置勾選</button>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-4 py-6 grid grid-cols-1 lg:grid-cols-12 gap-6">
    <!-- Sidebar -->
    <aside class="no-print lg:col-span-4">
      <div class="rounded-2xl border bg-white shadow-sm p-4">
        <div class="text-sm font-semibold">快速搜尋</div>
        <div class="mt-2 flex gap-2">
          <input id="q" type="search" placeholder="搜尋：地點、餐廳、關鍵字…" class="w-full rounded-xl border px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-200" />
        </div>
        <div class="mt-3 flex flex-wrap gap-2">
          <button class="chip" data-chip="札幌">札幌</button>
          <button class="chip" data-chip="支笏湖">支笏湖</button>
          <button class="chip" data-chip="洞爺湖">洞爺湖</button>
          <button class="chip" data-chip="Outlet">Outlet</button>
          <button class="chip" data-chip="雪祭">雪祭</button>
        </div>

        <div class="mt-6">
          <div class="text-sm font-semibold">導覽</div>
          <div id="nav" class="mt-2 grid gap-2"></div>
        </div>
      </div>

      <div class="mt-6 rounded-2xl border bg-white shadow-sm p-4">
        <div class="flex items-start justify-between gap-3">
          <div>
            <div class="text-sm font-semibold">關鍵時間點（Cheat Sheet）</div>
            <div class="text-xs text-slate-600 mt-1">冬季營業時間可能變動，到場以公告為準</div>
          </div>
          <button id="btnCopyCheat" class="rounded-xl border px-3 py-2 text-xs hover:bg-slate-50">複製</button>
        </div>
        <div class="mt-3 overflow-auto">
          <table class="w-full text-sm">
            <thead class="text-slate-600">
              <tr>
                <th class="text-left font-medium py-2">地點</th>
                <th class="text-left font-medium py-2">時間</th>
                <th class="text-left font-medium py-2">備註</th>
              </tr>
            </thead>
            <tbody id="cheat"></tbody>
          </table>
        </div>
      </div>

      <div class="mt-6 rounded-2xl border bg-white shadow-sm p-4">
        <div class="text-sm font-semibold">旅行小抄</div>
        <ul class="mt-2 text-sm text-slate-700 list-disc pl-5 space-y-1">
          <li>建議抵達機場後先處理：入境、領行李、JR/交通卡、現金與補給。</li>
          <li>多數景點冬季閉園早：動物園、雪上活動、熊牧場都要抓時間。</li>
          <li>自駕日請預留：加油、停車、雪地行車速度、兒童上廁所時間。</li>
          <li>偏僻住宿（Hotel Cocoa）周邊餐廳少：務必先在溫泉街用餐與補給。</li>
          <li>勾選會自動保存到本機（離線也可用）。</li>
        </ul>
      </div>
    </aside>

    <!-- Content -->
    <section class="lg:col-span-8">
      <div class="rounded-2xl border bg-white shadow-sm p-5 print-block">
        <div class="text-base font-semibold">行程概覽</div>
        <div class="mt-2 text-sm text-slate-700">主題：雪地放電、動物互動、溫泉療癒、美食購物｜成員：4大3小</div>

        <div class="mt-4 grid md:grid-cols-2 gap-4">
          <div class="rounded-2xl border p-4">
            <div class="text-sm font-semibold">航班資訊</div>
            <div class="mt-2 text-sm text-slate-700 space-y-1">
              <div><span class="font-medium">去程（1/30）：</span>TPE 桃園 → CTS 新千歲（預計 17:00–18:30 抵達，札幌市區約 20:00）</div>
              <div><span class="font-medium">回程（2/4）：</span>CTS 新千歲 → TPE（建議起飛前 3 小時到機場）</div>
            </div>
          </div>
          <div class="rounded-2xl border p-4">
            <div class="text-sm font-semibold">住宿清單</div>
            <div class="mt-2 text-sm text-slate-700 space-y-2" id="hotels"></div>
          </div>
        </div>
      </div>

      <div class="mt-6" id="results"></div>

      <div class="mt-6 no-print text-xs text-slate-500">
        小提醒：此頁面是你專用的「可查詢旅遊手冊」。你可以把它存成書籤，或在手機瀏覽器加入主畫面。
      </div>
    </section>
  </main>

  <template id="dayCardTpl">
    <article class="rounded-2xl border bg-white shadow-sm p-5 print-block">
      <div class="flex items-start justify-between gap-3">
        <div>
          <div class="text-sm text-slate-600" data-subtitle></div>
          <h2 class="text-lg font-semibold" data-title></h2>
        </div>
        <div class="flex items-center gap-2 no-print">
          <button class="btnJump rounded-xl border px-3 py-2 text-xs hover:bg-slate-50" data-jump>跳到這天</button>
        </div>
      </div>

      <div class="mt-4 grid gap-3" data-items></div>
    </article>
  </template>

  <template id="itemTpl">
    <div class="rounded-2xl border p-4">
      <div class="flex items-start justify-between gap-3">
        <div class="min-w-0">
          <div class="text-sm text-slate-600" data-time></div>
          <div class="font-semibold" data-name></div>
          <div class="mt-1 text-sm text-slate-700" data-desc></div>
          <div class="mt-2 flex flex-wrap gap-2" data-tags></div>
        </div>
        <div class="flex flex-col items-end gap-2 no-print">
          <label class="inline-flex items-center gap-2 text-xs text-slate-700 select-none">
            <input type="checkbox" class="h-4 w-4" data-done />
            完成
          </label>
          <button class="rounded-xl border px-3 py-2 text-xs hover:bg-slate-50" data-map>地圖</button>
          <button class="rounded-xl border px-3 py-2 text-xs hover:bg-slate-50" data-copy>複製</button>
        </div>
      </div>
      <div class="mt-3 text-xs text-slate-500" data-extra></div>
    </div>
  </template>

  <script>
    const data = {
      meta: {
        title: "北海道冬之親子大縱走",
        dateRange: "2026/01/30（五）– 2026/02/04（三）",
      },
      hotels: [
        {
          date: "1/30–1/31",
          place: "札幌",
          name: "Hotel Resol Trinity Sapporo（札幌三位神大飯店）",
          note: "大通公園旁，位置絕佳",
          address: "北海道札幌市中央區大通西5-3",
        },
        {
          date: "2/01",
          place: "北湯澤",
          name: "Mori no Soraniwa（森之空庭）",
          note: "含早晚餐，親子設施豐富（記得帶泳衣）",
          address: "伊達市大滝區北湯澤溫泉町300-7",
        },
        {
          date: "2/02",
          place: "洞爺湖（月浦）",
          name: "Hotel Cocoa（可可飯店）",
          note: "湖西側偏僻；先在洞爺湖溫泉街吃飯與補給",
          address: "102-18 Tsukiura, Toyako（洞爺湖町月浦 102-18）",
        },
        {
          date: "2/03",
          place: "札幌",
          name: "Hotel Gracery Sapporo（格拉斯麗札幌酒店）",
          note: "札幌車站正對面，交通便利",
          address: "札幌市中央區北4條西4丁目1",
        },
      ],
      cheat: [
        { place: "北海道神宮", time: "07:00–16:00", note: "茶屋建議 15:00 前到" },
        { place: "圓山動物園", time: "09:30–16:00", note: "最後入園 15:30；真的很早關" },
        { place: "瀧野鈴蘭丘陵公園", time: "09:00–16:00", note: "雪胎/雪上活動 16:00 準時結束" },
        { place: "支笏湖冰濤祭", time: "10:00–20:00", note: "16:30 點燈（建議 15:30 抵達）" },
        { place: "登別尼克斯海洋公園", time: "09:00–17:00", note: "最後入園 16:30；企鵝遊行常見 11:00 / 14:15" },
        { place: "昭和新山熊牧場", time: "08:30–16:30", note: "買蘋果餵熊，小孩很買單" },
        { place: "三井 Outlet 札幌北廣島", time: "10:00–20:00", note: "美食街 10:30–21:00" },
      ],
      days: [
        {
          id: "day1",
          date: "Day 1｜1/30（五）",
          title: "抵達札幌：宵夜與休息",
          items: [
            {
              time: "18:30",
              name: "抵達新千歲機場（CTS）",
              desc: "入境、領取行李約 1 小時。",
              tags: ["交通"],
              mapQuery: "New Chitose Airport",
              extra: "若有小孩易累，可先買水與小點心。",
            },
            {
              time: "19:30",
              name: "JR 快速機場線前往札幌站",
              desc: "車程約 40 分鐘。札幌站可轉地下鐵南北線/東豐線至大通站，飯店在大通站旁。",
              tags: ["交通", "轉乘"],
              mapQuery: "Sapporo Station",
            },
            {
              time: "20:30",
              name: "Check-in：Hotel Resol Trinity Sapporo",
              desc: "大通公園旁。",
              tags: ["住宿", "札幌"],
              mapQuery: "Hotel Resol Trinity Sapporo",
              extra: "晚餐建議附近簡單吃；也可逛狸小路補給（唐吉訶德 24H）。",
            },
          ],
        },
        {
          id: "day2",
          date: "Day 2｜1/31（六）",
          title: "神社祈福與北極熊相遇（札幌市區）",
          items: [
            {
              time: "09:00",
              name: "北海道神宮",
              desc: "冬季開放 07:00–16:00。記得 15:00 前到六花亭茶屋（以免賣完）。",
              tags: ["札幌", "景點"],
              mapQuery: "Hokkaido Shrine",
            },
            {
              time: "12:00",
              name: "午餐：圓山公園附近",
              desc: "可依現場狀況選擇。",
              tags: ["用餐"],
              mapQuery: "Maruyama Park Sapporo",
            },
            {
              time: "13:30",
              name: "圓山動物園",
              desc: "冬季 09:30–16:00（最後入園 15:30）。建議午飯後盡快入園，至少留 2.5 小時。",
              tags: ["札幌", "親子", "動物"],
              mapQuery: "Maruyama Zoo",
            },
            {
              time: "18:00",
              name: "晚餐：已預定餐廳",
              desc: "請確認餐廳名稱與預約時間，準時抵達。",
              tags: ["用餐"],
              mapQuery: "Sapporo",
              extra: "你可以把餐廳名稱貼到這一行（之後搜尋更方便）。",
            },
          ],
        },
        {
          id: "day3",
          date: "Day 3｜2/01（日）",
          title: "自駕啟程：雪地狂歡與冰濤祭",
          items: [
            {
              time: "09:00",
              name: "取車（租車公司）",
              desc: "自駕日建議先確認雪胎、兒童座椅、ETC、保險與加油規則。",
              tags: ["自駕"],
              mapQuery: "Sapporo",
            },
            {
              time: "10:30–13:30",
              name: "瀧野鈴蘭丘陵公園：雪上活動",
              desc: "冬季 09:00–16:00。雪胎與滑雪道 16:00 準時關閉。",
              tags: ["親子", "雪"],
              mapQuery: "Takino Suzuran Hillside Park",
            },
            {
              time: "15:30–17:30",
              name: "支笏湖冰濤祭",
              desc: "活動 10:00–20:00；16:30 點燈。建議 15:30 抵達看白天與點燈後景色。",
              tags: ["祭典", "夜景"],
              mapQuery: "Lake Shikotsu Ice Festival",
            },
            {
              time: "18:30",
              name: "Check-in：Mori no Soraniwa（森之空庭）",
              desc: "含早晚餐（Buffet）。室內/室外溫泉海灘親子設施豐富。",
              tags: ["溫泉", "住宿", "親子"],
              mapQuery: "Mori no Soraniwa",
              extra: "務必攜帶泳衣。",
            },
          ],
        },
        {
          id: "day4",
          date: "Day 4｜2/02（一）",
          title: "海洋生物與熊的冒險（登別/洞爺）",
          items: [
            {
              time: "09:30",
              name: "登別尼克斯海洋公園",
              desc: "09:00–17:00（最後入園 16:30）。企鵝遊行常見 11:00 與 14:15（入園時確認）。",
              tags: ["親子", "動物"],
              mapQuery: "Noboribetsu Marine Park Nixe",
            },
            {
              time: "13:30",
              name: "昭和新山熊牧場",
              desc: "冬季 08:30–16:30。建議停留 1 小時，買蘋果餵熊很有趣。",
              tags: ["親子", "動物"],
              mapQuery: "Showa Shinzan Bear Park",
            },
            {
              time: "16:00",
              name: "洞爺湖溫泉街：晚餐與補給",
              desc: "重要：今晚入住飯店附近偏僻，沒有餐廳。請先在溫泉街用餐並到便利商店補給。",
              tags: ["用餐", "補給"],
              mapQuery: "Toyako Onsen",
            },
            {
              time: "19:00",
              name: "Check-in：Hotel Cocoa（可可飯店）",
              desc: "洞爺湖西岸，距離溫泉街約 15 分鐘車程。湖景房早晨風景佳，不含早餐。",
              tags: ["住宿", "洞爺湖"],
              mapQuery: "Hotel Cocoa Toyako",
            },
          ],
        },
        {
          id: "day5",
          date: "Day 5｜2/03（二）",
          title: "購物與雪祭前夜（返回札幌）",
          items: [
            {
              time: "10:00",
              name: "離開 Hotel Cocoa 北上",
              desc: "預留加油與休息站時間。",
              tags: ["自駕"],
              mapQuery: "Toyako",
            },
            {
              time: "11:30",
              name: "F Village（Es Con Field HOKKAIDO）",
              desc: "09:30–21:00（各店不同）。前往 Outlet 路上的中停點。",
              tags: ["球場", "逛街"],
              mapQuery: "ES CON FIELD HOKKAIDO",
            },
            {
              time: "14:00",
              name: "三井 Outlet Park 札幌北廣島",
              desc: "商店 10:00–20:00；美食街 10:30–21:00。室內暖和適合小孩休息。",
              tags: ["購物", "親子"],
              mapQuery: "Mitsui Outlet Park Sapporo-Kitahiroshima",
            },
            {
              time: "17:30",
              name: "回札幌市區／還車（建議）",
              desc: "若隔天不需要用車，可考慮今晚先還車，減少隔日壓力。",
              tags: ["自駕", "交通"],
              mapQuery: "Sapporo",
            },
            {
              time: "入住",
              name: "Hotel Gracery Sapporo",
              desc: "札幌車站南口正對面；可走地下街吃晚餐，不用吹風淋雪。",
              tags: ["住宿", "札幌"],
              mapQuery: "Hotel Gracery Sapporo",
            },
            {
              time: "18:30",
              name: "大通公園：雪祭試燈（前夜景）",
              desc: "步行約 10–15 分鐘。晚餐可在車站周邊或 Stellar Place（例如根室花丸）。",
              tags: ["雪祭", "夜景", "用餐"],
              mapQuery: "Odori Park",
            },
          ],
        },
        {
          id: "day6",
          date: "Day 6｜2/04（三）",
          title: "賦歸：機場採買",
          items: [
            {
              time: "早上",
              name: "整理行李 → 札幌站搭 JR 快速機場線",
              desc: "飯店在車站旁，移動方便。",
              tags: ["交通"],
              mapQuery: "Sapporo Station",
            },
            {
              time: "10:00",
              name: "新千歲機場最後採買",
              desc: "原訂『哆啦A夢空中樂園』已永久歇業（資料註記）。可改逛 Royce' Chocolate World、Hello Kitty Happy Flight、北海道拉麵道場。",
              tags: ["購物", "機場"],
              mapQuery: "New Chitose Airport",
              extra: "建議預留起飛前 3 小時到機場。",
            },
          ],
        },
      ],
    };

    // --- helpers ---
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    const storageKey = "hokkaido_trip_manual_v1";

    function loadState() {
      try { return JSON.parse(localStorage.getItem(storageKey) || "{}") } catch { return {}; }
    }
    function saveState(state) {
      localStorage.setItem(storageKey, JSON.stringify(state));
    }

    function toMapsUrl(q) {
      const query = encodeURIComponent(q);
      return `https://www.google.com/maps/search/?api=1&query=${query}`;
    }

    function renderHotels() {
      const root = $("#hotels");
      root.innerHTML = "";
      data.hotels.forEach(h => {
        const div = document.createElement("div");
        div.className = "rounded-xl border p-3";
        div.innerHTML = `
          <div class="text-xs text-slate-600">${h.date}｜${h.place}</div>
          <div class="font-semibold mt-0.5">${h.name}</div>
          <div class="text-sm text-slate-700 mt-1">${h.note}</div>
          <div class="mt-2 flex flex-wrap gap-2 no-print">
            <a class="rounded-xl border px-3 py-2 text-xs hover:bg-slate-50" target="_blank" rel="noreferrer" href="${toMapsUrl(h.address || h.name)}">地圖</a>
            <button class="btnCopyHotel rounded-xl border px-3 py-2 text-xs hover:bg-slate-50" data-copy="${(h.address || h.name).replaceAll('"','')}">複製地址</button>
          </div>
        `;
        root.appendChild(div);
      });

      $$(".btnCopyHotel").forEach(btn => {
        btn.addEventListener("click", async () => {
          const text = btn.getAttribute("data-copy") || "";
          await navigator.clipboard.writeText(text);
          btn.textContent = "已複製";
          setTimeout(() => btn.textContent = "複製地址", 900);
        });
      });
    }

    function renderCheat() {
      const tbody = $("#cheat");
      tbody.innerHTML = "";
      data.cheat.forEach(r => {
        const tr = document.createElement("tr");
        tr.className = "border-t";
        tr.innerHTML = `
          <td class="py-2 pr-2 font-medium">${r.place}</td>
          <td class="py-2 pr-2">${r.time}</td>
          <td class="py-2">${r.note}</td>
        `;
        tbody.appendChild(tr);
      });

      $("#btnCopyCheat").addEventListener("click", async () => {
        const lines = data.cheat.map(r => `${r.place}｜${r.time}｜${r.note}`).join("\n");
        await navigator.clipboard.writeText(lines);
        const btn = $("#btnCopyCheat");
        btn.textContent = "已複製";
        setTimeout(() => btn.textContent = "複製", 900);
      });
    }

    function buildNav() {
      const nav = $("#nav");
      nav.innerHTML = "";
      data.days.forEach(d => {
        const a = document.createElement("button");
        a.className = "w-full text-left rounded-xl border px-3 py-2 hover:bg-slate-50";
        a.innerHTML = `
          <div class="text-xs text-slate-600">${d.date}</div>
          <div class="text-sm font-semibold truncate">${d.title}</div>
        `;
        a.addEventListener("click", () => {
          document.getElementById(d.id)?.scrollIntoView({ behavior: "smooth", block: "start" });
        });
        nav.appendChild(a);
      });
    }

    function renderDays(filterText = "") {
      const state = loadState();
      const root = $("#results");
      root.innerHTML = "";

      const q = (filterText || "").trim().toLowerCase();

      const matches = (day, item) => {
        if (!q) return true;
        const hay = [
          day.date, day.title,
          item.time, item.name, item.desc,
          ...(item.tags || []),
          item.extra || "",
        ].join(" ").toLowerCase();
        return hay.includes(q);
      };

      data.days.forEach(day => {
        const matchedItems = day.items.filter(it => matches(day, it));
        if (q && matchedItems.length === 0) return;

        const card = $("#dayCardTpl").content.cloneNode(true);
        const article = card.querySelector("article");
        article.id = day.id;
        card.querySelector("[data-subtitle]").textContent = day.date;
        card.querySelector("[data-title]").textContent = day.title;

        const itemsRoot = card.querySelector("[data-items]");
        matchedItems.forEach((it, idx) => {
          const itEl = $("#itemTpl").content.cloneNode(true);
          itEl.querySelector("[data-time]").textContent = it.time;
          itEl.querySelector("[data-name]").textContent = it.name;
          itEl.querySelector("[data-desc]").textContent = it.desc;
          itEl.querySelector("[data-extra]").textContent = it.extra || "";

          const tags = itEl.querySelector("[data-tags]");
          (it.tags || []).forEach(t => {
            const s = document.createElement("span");
            s.className = "inline-flex items-center rounded-full bg-slate-100 px-2 py-1 text-xs text-slate-700";
            s.textContent = t;
            tags.appendChild(s);
          });

          const key = `${day.id}__${idx}`;
          const cb = itEl.querySelector("[data-done]");
          cb.checked = !!state[key];
          cb.addEventListener("change", () => {
            const next = loadState();
            next[key] = cb.checked;
            saveState(next);
          });

          const btnMap = itEl.querySelector("[data-map]");
          btnMap.addEventListener("click", () => {
            const q = it.mapQuery || it.name;
            window.open(toMapsUrl(q), "_blank", "noreferrer");
          });

          const btnCopy = itEl.querySelector("[data-copy]");
          btnCopy.addEventListener("click", async () => {
            const text = `${it.name}\n${it.desc}`;
            await navigator.clipboard.writeText(text);
            btnCopy.textContent = "已複製";
            setTimeout(() => btnCopy.textContent = "複製", 900);
          });

          itemsRoot.appendChild(itEl);
        });

        card.querySelector("[data-jump]").addEventListener("click", () => {
          article.scrollIntoView({ behavior: "smooth", block: "start" });
        });

        root.appendChild(card);
      });

      if (!root.children.length) {
        const empty = document.createElement("div");
        empty.className = "rounded-2xl border bg-white shadow-sm p-6 text-sm text-slate-700";
        empty.textContent = "找不到符合的內容。試試看換個關鍵字（例如：札幌、支笏湖、Outlet）。";
        root.appendChild(empty);
      }
    }

    function wireUI() {
      // chips
      $$(".chip").forEach(btn => {
        btn.className = "chip rounded-full border px-3 py-1.5 text-xs hover:bg-slate-50";
        btn.addEventListener("click", () => {
          $("#q").value = btn.getAttribute("data-chip") || "";
          renderDays($("#q").value);
        });
      });

      // search
      $("#q").addEventListener("input", (e) => {
        renderDays(e.target.value);
      });

      // print
      $("#btnPrint").addEventListener("click", () => window.print());

      // reset
      $("#btnReset").addEventListener("click", () => {
        localStorage.removeItem(storageKey);
        renderDays($("#q").value);
      });
    }

    // init
    renderHotels();
    renderCheat();
    buildNav();
    wireUI();
    renderDays("");
  </script>
</body>
</html>
