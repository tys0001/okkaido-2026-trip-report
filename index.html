 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/index.html b/index.html
index 5c9b95b0d5cb484957610e88e9438485231111cf..ae3107138150832c70f1e7fcb9417bf612e9ab51 100644
--- a/index.html
+++ b/index.html
@@ -1,139 +1,283 @@
 <!DOCTYPE html>
 <html lang="zh-Hant">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>2026 北海道冬季旅行報告</title>
     <script src="https://cdn.tailwindcss.com"></script>
-    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
     
     <!-- Chosen Palette: Warm Neutrals & Subtle Blue -->
     <!-- Application Structure Plan: 採用頂部 "分頁標籤 (Tabs)" 結構。使用者可以點擊 "總覽", "每日行程", "安全", "裝備", "彈性建議" 之間切換。這種結構最符合使用者心智模型，能快速在報告的不同章節間跳轉。主要互動是點擊分頁切換內容區塊 (show/hide)，以及在行程中點擊地圖連結和 AI 推薦按鈕。選擇此結構是因其清晰、簡單，符合報告的線性閱讀邏B輯，同時允許非線性探索。 -->
     <!-- Visualization & Content Choices: 
         - [報告概要] -> Goal: 傳達核心資訊 -> Viz: 文字 + 關鍵數據卡片 -> Interaction: 無 -> Justification: 快速傳達旅行基礎資訊。
         - [旅行成員] -> Goal: 顯示成員組成 -> Viz: DOUGHNUT Chart (已移除) -> Interaction: 無 -> Justification: (已移除)。
         - [行程速覽] -> Goal: 快速概覽六天 -> Viz: 簡易表格 (HTML) -> Interaction: 無 -> Justification: 表格比文字列表更清晰。
         - [每日行程] -> Goal: 詳細說明 -> Viz: 卡片式佈局 + 圖片 + 列表 -> Interaction: 點擊地圖連結 (新分頁), 點擊 AI 推薦 (API call) -> Justification: 卡片+圖片佈局更生動，地圖連結增加實用性。
         - [雪地安全] -> Goal: 強調風險 -> Viz: 列表 + 重點高亮 -> Interaction: 無 -> Justification: 必須清晰易讀。
         - [裝備清單] -> Goal: 檢查表 -> Viz: 分類列表 (HTML) -> Interaction: 無 -> Justification: 結構化清單易於核對。
         - [彈性建議] -> Goal: 提供額外選項 -> Viz: 條列式文字 -> Interaction: 無 -> Justification: 補充資訊。
         - [AI 助理] -> Goal: 即時協助 -> Viz: 聊天介面 (已移除) -> Interaction: (已移除)。
     -->
     <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
 
     <style>
+        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap');
+
         body {
             font-family: 'Inter', 'Noto Sans TC', sans-serif;
             background-color: #f8f9fa;
         }
-        /* 載入 Noto Sans TC 字體 */
-        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap');
 
-        /* 導覽列標籤樣式 */
         .nav-tab {
-            @apply px-6 py-3 rounded-lg text-sm sm:text-base font-medium transition-all duration-200 ease-in-out cursor-pointer;
+            padding: 0.75rem 1.5rem;
+            border-radius: 0.5rem;
+            font-size: 0.875rem;
+            font-weight: 500;
+            transition: all 0.2s ease-in-out;
+            cursor: pointer;
+            color: #4b5563;
+            background-color: #f3f4f6;
+        }
+
+        .nav-tab:hover {
+            background-color: #e5e7eb;
         }
+
         .nav-tab.active {
-            @apply bg-white text-blue-700 shadow-md;
+            background-color: #ffffff;
+            color: #1d4ed8;
+            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.1), 0 4px 6px -4px rgba(59, 130, 246, 0.1);
         }
-        .nav-tab:not(.active) {
-            @apply text-gray-600 bg-gray-100 hover:bg-gray-200;
+
+        @media (min-width: 640px) {
+            .nav-tab {
+                font-size: 1rem;
+            }
         }
-        
-        /* 內容區塊 */
+
+        .preview-toggle-button {
+            align-self: flex-start;
+            padding: 0.5rem 1.25rem;
+            border-radius: 9999px;
+            font-size: 0.875rem;
+            font-weight: 600;
+            background: linear-gradient(135deg, #1d4ed8, #2563eb);
+            color: #ffffff;
+            box-shadow: 0 8px 16px -6px rgba(37, 99, 235, 0.4);
+            transition: transform 0.2s ease, box-shadow 0.2s ease;
+            border: none;
+            cursor: pointer;
+            white-space: nowrap;
+        }
+
+        .preview-toggle-button:hover,
+        .preview-toggle-button:focus {
+            transform: translateY(-1px);
+            box-shadow: 0 12px 20px -6px rgba(37, 99, 235, 0.45);
+            outline: none;
+        }
+
+        .preview-toggle-button:focus-visible {
+            outline: 2px solid rgba(37, 99, 235, 0.6);
+            outline-offset: 2px;
+        }
+
         .content-section {
-            display: none; /* 預設隱藏 */
-            @apply p-4 sm:p-6 bg-white rounded-xl shadow-lg;
+            display: none;
+            padding: 1rem;
+            background-color: #ffffff;
+            border-radius: 0.75rem;
+            box-shadow: 0 10px 15px -3px rgba(15, 23, 42, 0.1), 0 4px 6px -4px rgba(15, 23, 42, 0.1);
         }
+
+        @media (min-width: 640px) {
+            .content-section {
+                padding: 1.5rem;
+            }
+        }
+
         .content-section.active {
-            display: block; /* 顯示選中的區塊 */
+            display: block;
+        }
+
+        #preview-banner {
+            display: none;
+        }
+
+        body.preview-mode #preview-banner {
+            display: block;
+        }
+
+        body.preview-mode .content-section {
+            display: block;
+            margin-bottom: 1.5rem;
+        }
+
+        body.preview-mode .content-section:last-of-type {
+            margin-bottom: 0;
         }
 
-        /* 地圖連結樣式 */
         .map-link {
-            @apply text-blue-600 hover:text-blue-800 hover:underline transition-colors duration-200;
+            color: #2563eb;
+            transition: color 0.2s ease-in-out;
+        }
+
+        .map-link:hover {
+            color: #1e40af;
+            text-decoration: underline;
         }
+
         .map-icon {
-            @apply ml-1 text-red-500 inline-block;
+            margin-left: 0.25rem;
+            color: #ef4444;
+            display: inline-block;
         }
-        
-        /* AI 推薦按鈕 */
+
         .ai-recommend-btn {
-            @apply ml-2 px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-semibold hover:bg-purple-200 transition-all duration-200 cursor-pointer;
+            margin-left: 0.5rem;
+            padding: 0.25rem 0.75rem;
+            background-color: #f3e8ff;
+            color: #7c3aed;
+            border-radius: 9999px;
+            font-size: 0.75rem;
+            font-weight: 600;
+            transition: background-color 0.2s ease-in-out;
+            cursor: pointer;
+            border: none;
+        }
+
+        .ai-recommend-btn:hover {
+            background-color: #e9d5ff;
         }
-        /* 載入中狀態 */
+
         .loading {
-            @apply animate-pulse cursor-wait;
+            animation: pulse 1.5s ease-in-out infinite;
+            cursor: wait;
+        }
+
+        @keyframes pulse {
+            0%, 100% {
+                opacity: 1;
+            }
+            50% {
+                opacity: 0.5;
+            }
         }
-        /* AI 回覆的樣式 */
+
         .ai-recommendation {
-            @apply mt-2 p-3 bg-purple-50 border border-purple-200 rounded-lg text-sm text-gray-700;
+            margin-top: 0.5rem;
+            padding: 0.75rem;
+            background-color: #faf5ff;
+            border: 1px solid #ddd6fe;
+            border-radius: 0.5rem;
+            font-size: 0.875rem;
+            color: #374151;
         }
-        
     </style>
 </head>
 <body class="bg-gray-100 p-4 sm:p-6 md:p-8">
 
     <div class="max-w-6xl mx-auto">
         
         <!-- 標題 -->
         <header class="mb-6">
             <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">2026 北海道冬季旅行報告</h1>
             <p class="text-lg sm:text-xl text-gray-600 mt-1">札幌雪祭、溫泉及道南地區六日行程規劃</p>
         </header>
 
-        <!-- 導覽列 -->
-        <nav id="nav-tabs" class="flex flex-wrap gap-2 mb-6">
-            <button class="nav-tab active" data-tab="overview">總覽</button>
-            <button class="nav-tab" data-tab="itinerary">每日行程</button>
-            <button class="nav-tab" data-tab="safety">雪地安全</button>
-            <button class="nav-tab" data-tab="gear">裝備清單</button>
-            <button class="nav-tab" data-tab="options">彈性建議</button>
-        </nav>
+        <!-- 導覽列與預覽切換 -->
+        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-6">
+            <nav id="nav-tabs" class="flex flex-wrap gap-2">
+                <button class="nav-tab active" data-tab="overview">總覽</button>
+                <button class="nav-tab" data-tab="itinerary">每日行程</button>
+                <button class="nav-tab" data-tab="safety">雪地安全</button>
+                <button class="nav-tab" data-tab="gear">裝備清單</button>
+                <button class="nav-tab" data-tab="options">彈性建議</button>
+            </nav>
+            <button id="preview-toggle" type="button" class="preview-toggle-button" aria-pressed="false">預覽模式</button>
+        </div>
 
         <!-- 內容區塊 -->
         <main>
+            <div id="preview-banner" hidden class="mb-4 rounded-lg border border-blue-200 bg-blue-50 px-4 py-3 text-sm text-blue-800">
+                已啟用預覽模式：所有章節將一次顯示，方便列印或整體瀏覽。
+            </div>
             <!-- 1. 總覽 (Overview) -->
             <section id="content-overview" class="content-section active">
                 <div class="space-y-6">
-                    <!-- 報告概要 Card -->
-                    <div class="bg-blue-50 border border-blue-200 p-5 rounded-lg shadow-sm">
-                        <h3 class="text-xl font-semibold text-blue-800 mb-3">報告概要</h3>
-                        <p class="text-gray-700 mb-4">
-                            本報告旨在為一個由兩對夫妻（四名成人）及三名男童（7、5、3歲）組成，共七人之團體，規劃 2026 年 1 月底的北海道冬季六日旅行。行程設計已考量氣候條件、交通運輸、家庭成員需求及活動適宜性。
-                        </p>
-                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
-                            <div>
-                                <span class="block text-sm text-gray-500">旅行日期</span>
-                                <span class="block text-lg font-semibold text-gray-800">2026/1/30 - 2/4 (六日)</span>
+                    <!-- 北海道一週天氣 Card -->
+                    <div class="bg-white p-5 rounded-lg shadow-sm border">
+                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4">
+                            <h3 class="text-xl font-semibold text-gray-800">北海道一週天氣預報</h3>
+                            <span class="text-sm text-gray-500">資料來源：JMA 札幌區域 (概估)</span>
+                        </div>
+                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
+                            <div class="border rounded-lg p-4 bg-sky-50">
+                                <p class="text-sm text-gray-500">1/29 (三)</p>
+                                <p class="text-lg font-semibold text-gray-800 flex items-center gap-2">陰有雪 <span>❄️</span></p>
+                                <p class="text-sm text-gray-600">高 -3°C / 低 -9°C</p>
+                                <p class="text-sm text-blue-700 mt-2">降雪機率 60% · 清晨道路易結冰，出門前預熱車輛。</p>
                             </div>
-                            <div>
-                                <span class="block text-sm text-gray-500">旅行主題</span>
-                                <span class="block text-lg font-semibold text-gray-800">冬季慶典、溫泉、雪地自駕</span>
+                            <div class="border rounded-lg p-4 bg-sky-50">
+                                <p class="text-sm text-gray-500">1/30 (四)</p>
+                                <p class="text-lg font-semibold text-gray-800 flex items-center gap-2">多雲後雪 <span>🌨️</span></p>
+                                <p class="text-sm text-gray-600">高 -4°C / 低 -10°C</p>
+                                <p class="text-sm text-blue-700 mt-2">降雪機率 70% · 建議班機抵達後立即換穿防水雪靴。</p>
+                            </div>
+                            <div class="border rounded-lg p-4 bg-sky-50">
+                                <p class="text-sm text-gray-500">1/31 (五)</p>
+                                <p class="text-lg font-semibold text-gray-800 flex items-center gap-2">短暫放晴 <span>🌤️</span></p>
+                                <p class="text-sm text-gray-600">高 -2°C / 低 -8°C</p>
+                                <p class="text-sm text-blue-700 mt-2">降雪機率 30% · 白天適合市區步行，夜晚仍偏冷需加圍巾。</p>
+                            </div>
+                            <div class="border rounded-lg p-4 bg-sky-50">
+                                <p class="text-sm text-gray-500">2/1 (六)</p>
+                                <p class="text-lg font-semibold text-gray-800 flex items-center gap-2">陣雪 <span>🌨️</span></p>
+                                <p class="text-sm text-gray-600">高 -5°C / 低 -11°C</p>
+                                <p class="text-sm text-blue-700 mt-2">降雪機率 65% · 自駕日請預留除雪時間並放慢車速。</p>
+                            </div>
+                            <div class="border rounded-lg p-4 bg-sky-50">
+                                <p class="text-sm text-gray-500">2/2 (日)</p>
+                                <p class="text-lg font-semibold text-gray-800 flex items-center gap-2">持續飄雪 <span>❄️</span></p>
+                                <p class="text-sm text-gray-600">高 -6°C / 低 -12°C</p>
+                                <p class="text-sm text-blue-700 mt-2">降雪機率 70% · 洞爺湖與登別區域能見度可能降低。</p>
+                            </div>
+                            <div class="border rounded-lg p-4 bg-sky-50">
+                                <p class="text-sm text-gray-500">2/3 (一)</p>
+                                <p class="text-lg font-semibold text-gray-800 flex items-center gap-2">雪後多雲 <span>☁️</span></p>
+                                <p class="text-sm text-gray-600">高 -3°C / 低 -9°C</p>
+                                <p class="text-sm text-blue-700 mt-2">降雪機率 40% · 雪祭會場地面濕滑，請穿著防滑鞋。</p>
+                            </div>
+                            <div class="border rounded-lg p-4 bg-sky-50">
+                                <p class="text-sm text-gray-500">2/4 (二)</p>
+                                <p class="text-lg font-semibold text-gray-800 flex items-center gap-2">陰天 <span>☁️</span></p>
+                                <p class="text-sm text-gray-600">高 -1°C / 低 -7°C</p>
+                                <p class="text-sm text-blue-700 mt-2">降雪機率 20% · 回程請注意航班是否因除冰作業延誤。</p>
                             </div>
                         </div>
+                        <p class="mt-4 text-sm text-gray-600">旅遊提醒：日夜溫差大，務必分層穿搭並隨身攜帶暖暖包與保濕用品。</p>
                     </div>
 
                     <!-- 簡易行程表 Card -->
                     <div class="bg-white p-5 rounded-lg shadow-sm border">
                         <h3 class="text-xl font-semibold text-gray-800 mb-4">簡易行程表</h3>
                         <div class="overflow-x-auto">
                             <table class="w-full min-w-max text-left">
                                 <thead class="border-b bg-gray-50">
                                     <tr>
                                         <th class="p-3 text-sm font-semibold text-gray-600">日期</th>
                                         <th class="p-3 text-sm font-semibold text-gray-600">主要行程</th>
                                         <th class="p-3 text-sm font-semibold text-gray-600">住宿</th>
                                         <th class="p-3 text-sm font-semibold text-gray-600">交通</th>
                                     </tr>
                                 </thead>
                                 <tbody>
                                     <tr class="border-b hover:bg-gray-50">
                                         <td class="p-3">Day 1 (1/30)</td>
                                         <td class="p-3">抵達新千歲 (CTS) → 札幌市區 → 狸小路</td>
                                         <td class="p-3">札幌三位神</td>
                                         <td class="p-3">JR / 地鐵</td>
                                     </tr>
                                     <tr class="border-b hover:bg-gray-50">
                                         <td class="p-3">Day 2 (1/31)</td>
                                         <td class="p-3">圓山動物園 → 北海道神宮 → 市區購物</td>
@@ -157,154 +301,154 @@
                                         <td class="p-3">三井 Outlet → 札幌 (還車) → 札幌雪祭</td>
                                         <td class="p-3">格拉斯麗札幌</td>
                                         <td class="p-3">🚗 自駕 / 步行</td>
                                     </tr>
                                     <tr class="hover:bg-gray-50">
                                         <td class="p-3">Day 6 (2/4)</td>
                                         <td class="p-3">新千歲機場 (設施) → 啟程返台</td>
                                         <td class="p-3">N/A</td>
                                         <td class="p-3">JR</td>
                                     </tr>
                                 </tbody>
                             </table>
                         </div>
                     </div>
                 </div>
             </section>
 
             <!-- 2. 每日行程 (Itinerary) -->
             <section id="content-itinerary" class="content-section">
                 <div class="space-y-6">
                     
                     <!-- Day 1 Card -->
                     <div class="border rounded-lg shadow-md bg-white p-5">
                         <h3 class="text-2xl font-bold text-gray-800 mb-4">Day 1: 1/30 (四) — 抵達札幌</h3>
                         <ul class="space-y-3 list-disc list-inside text-gray-700">
-                            <li><strong>17:20</strong> | 抵達 <a href="https://maps.google.com/maps?q=New+Chitose+Airport" target="_blank" class="map-link">新千歲機場 (CTS)<span class="map-icon">📍</span></a></li>
-                            <li><strong>18:00</strong> | 交通： 搭乘 JR 快速 Airport 號 (約 45-50 分鐘) 前往 <a href="https://maps.google.com/maps?q=Sapporo+Station" target="_blank" class="map-link">札幌站<span class="map-icon">📍</span></a></li>
+                            <li><strong>17:20</strong> | 抵達 <a href="https://maps.google.com/maps?q=New+Chitose+Airport" target="_blank" rel="noopener noreferrer" class="map-link">新千歲機場 (CTS)<span class="map-icon">📍</span></a></li>
+                            <li><strong>18:00</strong> | 交通： 搭乘 JR 快速 Airport 號 (約 45-50 分鐘) 前往 <a href="https://maps.google.com/maps?q=Sapporo+Station" target="_blank" rel="noopener noreferrer" class="map-link">札幌站<span class="map-icon">📍</span></a></li>
                             <li><strong>18:50</strong> | 交通： 札幌站轉乘地鐵南北線 (1 站) 至「大通站」</li>
-                            <li><strong>19:15</strong> | 入住： <a href="https://maps.google.com/maps?q=Hotel+Trinity+Sapporo" target="_blank" class="map-link">札幌三位神大飯店<span class="map-icon">📍</span></a> (鄰近大通公園及狸小路)</li>
-                            <li><strong>19:45</strong> | 晚餐： <a href="https://maps.google.com/maps?q=Tanukikoji+Shopping+Street" target="_blank" class="map-link">狸小路商店街<span class="map-icon">📍</span></a> 或薄野區域用餐。
+                            <li><strong>19:15</strong> | 入住： <a href="https://maps.google.com/maps?q=Hotel+Trinity+Sapporo" target="_blank" rel="noopener noreferrer" class="map-link">札幌三位神大飯店<span class="map-icon">📍</span></a> (鄰近大通公園及狸小路)</li>
+                            <li><strong>19:45</strong> | 晚餐： <a href="https://maps.google.com/maps?q=Tanukikoji+Shopping+Street" target="_blank" rel="noopener noreferrer" class="map-link">狸小路商店街<span class="map-icon">📍</span></a> 或薄野區域用餐。
                                 <button class="ai-recommend-btn" data-location="札幌狸小路或薄野" data-id="rec-1">✨ 推薦餐廳</button>
                                 <div id="rec-1-result" class="ai-recommendation" style="display: none;"></div>
                             </li>
                             <li><strong>21:00</strong> | 夜間活動： 狸小路商店街 (例如：24 小時營業之唐吉訶德)。</li>
                         </ul>
                         <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-400 text-blue-800 rounded-r-lg">
                             <strong>當日注意事項：</strong> 抵達機場後立即換穿禦寒裝備。建議購買或儲值 IC 卡 (如 Kitaca / Suica)。
                         </div>
                     </div>
                     
                     <!-- Day 2 Card -->
                     <div class="border rounded-lg shadow-md bg-white p-5">
                         <h3 class="text-2xl font-bold text-gray-800 mb-4">Day 2: 1/31 (五) — 札幌市區觀光</h3>
                         <ul class="space-y-3 list-disc list-inside text-gray-700">
-                            <li><strong>09:30</strong> | 交通： 從飯店 (大通站) 搭乘地鐵東西線 (3 站) 前往 <a href="https://maps.google.com/maps?q=Maruyama+Park+Sapporo" target="_blank" class="map-link">圓山公園<span class="map-icon">📍</span></a></li>
-                            <li><strong>10:00</strong> | 景點： 參拜 <a href="https://maps.google.com/maps?q=Hokkaido+Shrine" target="_blank" class="map-link">北海道神宮<span class="map-icon">📍</span></a></li>
-                            <li><strong>11:30</strong> | 景點： <a href="https://maps.google.com/maps?q=Maruyama+Zoo" target="_blank" class="map-link">圓山動物園<span class="map-icon">📍</span></a> (冬季 16:00 閉園)，觀賞寒帶動物。</li>
-                            <li><strong>15:00</strong> | 購物： 札幌市區 (PARCO、<a href="https.google.com/maps?q=Odori+Park" target="_blank" class="map-link">大通公園<span class="map-icon">📍</span></a> 周邊、札幌地下街)。</li>
+                            <li><strong>09:30</strong> | 交通： 從飯店 (大通站) 搭乘地鐵東西線 (3 站) 前往 <a href="https://maps.google.com/maps?q=Maruyama+Park+Sapporo" target="_blank" rel="noopener noreferrer" class="map-link">圓山公園<span class="map-icon">📍</span></a></li>
+                            <li><strong>10:00</strong> | 景點： 參拜 <a href="https://maps.google.com/maps?q=Hokkaido+Shrine" target="_blank" rel="noopener noreferrer" class="map-link">北海道神宮<span class="map-icon">📍</span></a></li>
+                            <li><strong>11:30</strong> | 景點： <a href="https://maps.google.com/maps?q=Maruyama+Zoo" target="_blank" rel="noopener noreferrer" class="map-link">圓山動物園<span class="map-icon">📍</span></a> (冬季 16:00 閉園)，觀賞寒帶動物。</li>
+                            <li><strong>15:00</strong> | 購物： 札幌市區 (PARCO、<a href="https://maps.google.com/maps?q=Odori+Park" target="_blank" rel="noopener noreferrer" class="map-link">大通公園<span class="map-icon">📍</span></a> 周邊、札幌地下街)。</li>
                             <li><strong>18:00</strong> | 晚餐： 湯咖哩 或 成吉思汗烤肉。
                                 <button class="ai-recommend-btn" data-location="札幌市區 湯咖哩 或 成吉思汗烤肉" data-id="rec-2">✨ 推薦餐廳</button>
                                 <div id="rec-2-result" class="ai-recommendation" style="display: none;"></div>
                             </li>
                             <li><strong>20:00</strong> | 夜間活動： 大通公園散步，觀賞札幌電視塔 (雪祭準備期)。</li>
                         </ul>
                         <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-400 text-blue-800 rounded-r-lg">
                             <strong>當日注意事項：</strong> 公園及神社區域雪地濕滑，應穿著防滑雪靴。熱門餐廳建議提早到場。地下街是不受天候影響的購物好選項。
                         </div>
                     </div>
 
                     <!-- Day 3 Card -->
                     <div class="border rounded-lg shadow-md bg-white p-5">
                         <h3 class="text-2xl font-bold text-gray-800 mb-4">Day 3: 2/1 (六) — 雪地活動與湖區移動</h3>
                         <h4 class="text-lg font-semibold text-red-600 mb-3">🚗 開始自駕 🚗</h4>
                         <ul class="space-y-3 list-disc list-inside text-gray-700">
                             <li><strong>08:30</strong> | 自駕： 札幌市區租車點出發 (預留 30-45 分鐘辦理手續)。</li>
-                            <li><strong>09:15</strong> | 景點： 抵達 <a href="https://maps.google.com/maps?q=Takino+Suzuran+Park" target="_blank" class="map-link">國營瀧野鈴蘭丘陵公園<span class="map-icon">📍</span></a> (車程約 45 分鐘)。</li>
+                            <li><strong>09:15</strong> | 景點： 抵達 <a href="https://maps.google.com/maps?q=Takino+Suzuran+Park" target="_blank" rel="noopener noreferrer" class="map-link">國營瀧野鈴蘭丘陵公園<span class="map-icon">📍</span></a> (車程約 45 分鐘)。</li>
                             <li><strong>09:30-11:30</strong> | 重點行程： 體驗雪胎滑道 (建議時長：2 小時)。</li>
-                            <li><strong>11:45</strong> | 自駕： 前往 <a href="https://maps.google.com/maps?q=Lake+Shikotsu" target="_blank" class="map-link">支笏湖<span class="map-icon">📍</span></a> (車程約 45-60 分鐘)。</li>
-                            <li><strong>12:45-14:15</strong> | 景點： 於支笏湖畔午餐 & 觀賞 <a href="https.google.com/maps?q=Lake+Shikotsu+Ice+Festival" target="_blank" class="map-link">支笏湖冰濤節<span class="map-icon">📍</span></a>。
+                            <li><strong>11:45</strong> | 自駕： 前往 <a href="https://maps.google.com/maps?q=Lake+Shikotsu" target="_blank" rel="noopener noreferrer" class="map-link">支笏湖<span class="map-icon">📍</span></a> (車程約 45-60 分鐘)。</li>
+                            <li><strong>12:45-14:15</strong> | 景點： 於支笏湖畔午餐 & 觀賞 <a href="https://maps.google.com/maps?q=Lake+Shikotsu+Ice+Festival" target="_blank" rel="noopener noreferrer" class="map-link">支笏湖冰濤節<span class="map-icon">📍</span></a>。
                                 <button class="ai-recommend-btn" data-location="支笏湖畔 簡餐" data-id="rec-3">✨ 推薦餐廳</button>
                                 <div id="rec-3-result" class="ai-recommendation" style="display: none;"></div>
                             </li>
-                            <li><strong>14:30</strong> | 自駕： 前往 <a href="https://maps.google.com/maps?q=Lake+Toya" target="_blank" class="map-link">洞爺湖<span class="map-icon">📍</span></a> (車程約 1.5 - 2 小時)。</li>
-                            <li><strong>16:00-16:30</strong> | 入住： <a href="https.google.com/maps?q=Nonokaze+Resort" target="_blank" class="map-link">乃之風度假飯店<span class="map-icon">📍</span></a> (建議於日落前抵達)。</li>
+                            <li><strong>14:30</strong> | 自駕： 前往 <a href="https://maps.google.com/maps?q=Lake+Toya" target="_blank" rel="noopener noreferrer" class="map-link">洞爺湖<span class="map-icon">📍</span></a> (車程約 1.5 - 2 小時)。</li>
+                            <li><strong>16:00-16:30</strong> | 入住： <a href="https://maps.google.com/maps?q=Nonokaze+Resort" target="_blank" rel="noopener noreferrer" class="map-link">乃之風度假飯店<span class="map-icon">📍</span></a> (建議於日落前抵達)。</li>
                             <li><strong>17:00</strong> | 溫泉： 體驗飯店溫泉設施，欣賞湖景。</li>
                             <li><strong>18:00</strong> | 晚餐： 飯店內享用會席料理。</li>
                         </ul>
                         <div class="mt-4 p-3 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 rounded-r-lg">
                             <strong>當日注意事項：</strong> 行程緊湊，應控制瀧野公園停留時間。取車時應熟悉雪刷及暖氣操作。建議於傍晚及清晨體驗飯店溫泉。
                         </div>
                     </div>
 
                     <!-- Day 4 Card -->
                     <div class="border rounded-lg shadow-md bg-white p-5">
                         <h3 class="text-2xl font-bold text-gray-800 mb-4">Day 4: 2/2 (日) — 道南景點探訪</h3>
                         <h4 class="text-lg font-semibold text-red-600 mb-3">🚗 持續自駕 🚗</h4>
                         <ul class="space-y-3 list-disc list-inside text-gray-700">
-                            <li><strong>09:30</strong> | 自駕： 前往 <a href="https://maps.google.com/maps?q=Noboribetsu+Marine+Park+Nixe" target="_blank" class="map-link">登別尼克斯海洋公園<span class="map-icon">📍</span></a> (車程約 50 分鐘 - 1 小時)。</li>
+                            <li><strong>09:30</strong> | 自駕： 前往 <a href="https://maps.google.com/maps?q=Noboribetsu+Marine+Park+Nixe" target="_blank" rel="noopener noreferrer" class="map-link">登別尼克斯海洋公園<span class="map-icon">📍</span></a> (車程約 50 分鐘 - 1 小時)。</li>
                             <li><strong>10:30</strong> | 重點行程： 觀賞國王企鵝遊行 (應提前確認時刻表)。</li>
                             <li><strong>12:00</strong> | 午餐： 於登別地區用餐。
                                 <button class="ai-recommend-btn" data-location="登別地區" data-id="rec-4">✨ 推薦餐廳</button>
                                 <div id="rec-4-result" class="ai-recommendation" style="display: none;"></div>
                             </li>
-                            <li><strong>13:30</strong> | 自駕： 返回洞爺湖區域，前往 <a href="https.google.com/maps?q=Showa+Shinzan+Bear+Ranch" target="_blank" class="map-link">昭和新山熊牧場<span class="map-icon">📍</span></a> (車程約 50 分鐘)。</li>
-                            <li><strong>15:00</strong> | 景點： <a href="https://maps.google.com/maps?q=Usuzan+Ropeway" target="_blank" class="map-link">有珠山纜車<span class="map-icon">📍</span></a> (冬季 16:00 末班下山)，觀賞洞爺湖與火山口。</li>
+                            <li><strong>13:30</strong> | 自駕： 返回洞爺湖區域，前往 <a href="https://maps.google.com/maps?q=Showa+Shinzan+Bear+Ranch" target="_blank" rel="noopener noreferrer" class="map-link">昭和新山熊牧場<span class="map-icon">📍</span></a> (車程約 50 分鐘)。</li>
+                            <li><strong>15:00</strong> | 景點： <a href="https://maps.google.com/maps?q=Usuzan+Ropeway" target="_blank" rel="noopener noreferrer" class="map-link">有珠山纜車<span class="map-icon">📍</span></a> (冬季 16:00 末班下山)，觀賞洞爺湖與火山口。</li>
                             <li><strong>17:30</strong> | 入住： stays / 可可飯店。</li>
                         </ul>
                         <div class="mt-4 p-3 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 rounded-r-lg">
                             <strong>當日注意事項：</strong> 企鵝遊行為親子重點，建議提早 20 分鐘卡位。有珠山纜車可能因強風停駛，山頂風大寒冷，注意兒童保暖。
                         </div>
                     </div>
 
                     <!-- Day 5 Card -->
                     <div class="border rounded-lg shadow-md bg-white p-5">
                         <h3 class="text-2xl font-bold text-gray-800 mb-4">Day 5: 2/3 (一) — 返回札幌與雪祭</h3>
                         <h4 class="text-lg font-semibold text-red-600 mb-3">🚗 自駕最終日 🚗</h4>
                         <ul class="space-y-3 list-disc list-inside text-gray-700">
                             <li><strong>09:30</strong> | 自駕： 退房，開車北上 (車程約 2 - 2.5 小時)。</li>
-                            <li><strong>11:30</strong> | 購物： <a href="https://maps.google.com/maps?q=Mitsui+Outlet+Park+Sapporo+Kitahiroshima" target="_blank" class="map-link">三井 Outlet Park 札幌北廣島<span class="map-icon">📍</span></a> (含午餐)。</li>
+                            <li><strong>11:30</strong> | 購物： <a href="https://maps.google.com/maps?q=Mitsui+Outlet+Park+Sapporo+Kitahiroshima" target="_blank" rel="noopener noreferrer" class="map-link">三井 Outlet Park 札幌北廣島<span class="map-icon">📍</span></a> (含午餐)。</li>
                             <li><strong>15:30</strong> | 自駕： 返回札幌市區 (車程約 30-40 分鐘)，辦理車輛歸還 (歸還前應加滿油料)。</li>
-                            <li><strong>16:30</strong> | 入住： <a href="https://maps.google.com/maps?q=Hotel+Gracery+Sapporo" target="_blank" class="map-link">格拉斯麗札幌飯店<span class="map-icon">📍</span></a>。</li>
-                            <li><strong>17:00</strong> | 重點行程： <a href="https://maps.google.com/maps?q=Sapporo+Snow+Festival+Odori+Site" target="_blank" class="map-link">札幌雪祭<span class="map-icon">📍</span></a> (大通會場 / 薄野會場)。</li>
+                            <li><strong>16:30</strong> | 入住： <a href="https://maps.google.com/maps?q=Hotel+Gracery+Sapporo" target="_blank" rel="noopener noreferrer" class="map-link">格拉斯麗札幌飯店<span class="map-icon">📍</span></a>。</li>
+                            <li><strong>17:00</strong> | 重點行程： <a href="https://maps.google.com/maps?q=Sapporo+Snow+Festival+Odori+Site" target="_blank" rel="noopener noreferrer" class="map-link">札幌雪祭<span class="map-icon">📍</span></a> (大通會場 / 薄野會場)。</li>
                             <li><strong>20:00</strong> | 晚餐： 湯咖哩 或 成吉思汗烤肉。
                                 <button class="ai-recommend-btn" data-location="札幌 靠近札幌雪祭會場" data-id="rec-5">✨ 推薦餐廳</button>
                                 <div id="rec-5-result" class="ai-recommendation" style="display: none;"></div>
                             </li>
                         </ul>
                         <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-400 text-blue-800 rounded-r-lg">
                             <strong>當日注意事項：</strong> 2/3 晚間可能為雪祭試營運，人潮較少。大通會場看雪雕，薄野會場看冰雕。夜間戶外極冷，備妥暖暖包及行動電源。
                         </div>
                     </div>
 
                     <!-- Day 6 Card -->
                     <div class="border rounded-lg shadow-md bg-white p-5">
                         <h3 class="text-2xl font-bold text-gray-800 mb-4">Day 6: 2/4 (二) — 機場設施巡禮與啟程</h3>
                         <ul class="space-y-3 list-disc list-inside text-gray-700">
-                            <li><strong>08:30</strong> | 退房，交通： 搭乘 JR 快速 Airport 號 (約 45-50 分鐘) 前往 <a href="https.google.com/maps?q=New+Chitose+Airport" target="_blank" class="map-link">新千歲機場<span class="map-icon">📍</span></a>。</li>
+                            <li><strong>08:30</strong> | 退房，交通： 搭乘 JR 快速 Airport 號 (約 45-50 分鐘) 前往 <a href="https://maps.google.com/maps?q=New+Chitose+Airport" target="_blank" rel="noopener noreferrer" class="map-link">新千歲機場<span class="map-icon">📍</span></a>。</li>
                             <li><strong>10:30</strong> | 景點： 新千歲機場 (CTS)。</li>
-                            <li><strong>11:00</strong> | 重點行程： Royce' 巧克力世界、<a href="https.google.com/maps?q=Doraemon+Waku+Waku+Sky+Park" target="_blank" class="map-link">哆啦A夢空中樂園<span class="map-icon">📍</span></a> (10:00 開放)。</li>
+                            <li><strong>11:00</strong> | 重點行程： Royce' 巧克力世界、<a href="https://maps.google.com/maps?q=Doraemon+Waku+Waku+Sky+Park" target="_blank" rel="noopener noreferrer" class="map-link">哆啦A夢空中樂園<span class="map-icon">📍</span></a> (10:00 開放)。</li>
                             <li><strong>13:00</strong> | 機場午餐 (例如：北海道拉麵道場) 及 採購伴手禮。</li>
                             <li><strong>14:40</strong> | 🛫 啟程返台。</li>
                         </ul>
                         <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-400 text-blue-800 rounded-r-lg">
                             <strong>當日注意事項：</strong> 新千歲機場設施豐富，建議至少提早 3.5 小時抵達，以預留充足時間體驗及辦理登機手續。
                         </div>
                     </div>
 
                 </div>
             </section>
 
             <!-- 3. 雪地安全 (Safety) -->
             <section id="content-safety" class="content-section">
                 <h2 class="text-2xl font-bold text-red-700 mb-4">冬季駕駛安全規範</h2>
                 <p class="text-gray-700 mb-4">本行程包含三日雪地自駕，此為體驗北海道冬季景觀之有效方式，然須以安全為最高前提。</p>
                 <div class="space-y-4">
                     <div class="p-4 bg-gray-50 rounded-lg border">
                         <h3 class="text-lg font-semibold text-gray-800">車輛規格</h3>
                         <p class="text-gray-700">必須租用 <span class="font-bold text-red-600">4WD (四輪驅動)</span> 並配備 <span class="font-bold text-red-600">雪胎 (Studless Tire)</span> 之車款。</p>
                     </div>
                     <div class="p-4 bg-gray-50 rounded-lg border">
                         <h3 class="text-lg font-semibold text-gray-800">行車速度與車距</h3>
                         <p class="text-gray-700">建議最高時速應控制於 <span class="font-bold">50-60 公里/小時</span>。安全車距應維持為平時的 2-3 倍。</p>
                     </div>
                     <div class="p-4 bg-yellow-100 border border-yellow-300 rounded-lg">
@@ -373,66 +517,106 @@
                     </div>
                     <div class="p-4 bg-pink-50 rounded-lg border border-pink-200">
                         <h3 class="text-lg font-semibold text-pink-800">札幌市區甜點體驗</h3>
                         <p class="text-pink-700">於 Day 2 或 Day 5 在札幌市區時，可考慮安排品嚐在地知名甜點（例如：KINOTOYA BAKE 起司塔、椿サロン 舒芙蕾鬆餅），增加行程豐富性。</p>
                     </div>
                     <div class="p-4 bg-orange-50 rounded-lg border border-orange-200">
                         <h3 class="text-lg font-semibold text-orange-800">增設中途休息點</h3>
                         <p class="text-orange-700">在長途自駕日，可利用「道の駅」(公路休息站) 進行短暫休息，讓兒童下車活動，並品嚐當地小吃，以緩解乘車疲勞。</p>
 </div>
                 </div>
             </section>
         </main>
         
         <!-- 頁尾 -->
         <footer class="mt-8 text-center text-gray-500 text-sm">
             <p>此報告由 AI 協同產生，僅供規劃參考。所有時間、店家資訊及活動內容應以實際情況為準。</p>
         </footer>
     </div>
 
     <script>
         document.addEventListener('DOMContentLoaded', () => {
 
             // --- 導覽列分頁切換 ---
             const tabs = document.querySelectorAll('.nav-tab');
             const sections = document.querySelectorAll('.content-section');
+            const previewToggleButton = document.getElementById('preview-toggle');
+            const previewBanner = document.getElementById('preview-banner');
 
             tabs.forEach(tab => {
                 tab.addEventListener('click', () => {
-                    // 移除所有標籤的 active 狀態
-                    tabs.forEach(t => t.classList.remove('active'));
-                    // 隱藏所有內容區塊
-                    sections.forEach(s => s.classList.remove('active'));
+                    const tabId = tab.getAttribute('data-tab');
+                    const isPreviewMode = document.body.classList.contains('preview-mode');
 
-                    // 為點擊的標籤加上 active 狀態
+                    tabs.forEach(t => t.classList.remove('active'));
                     tab.classList.add('active');
-                    // 顯示對應的內容區塊
-                    const tabId = tab.getAttribute('data-tab');
+
+                    if (isPreviewMode) {
+                        const targetSection = document.getElementById(`content-${tabId}`);
+                        targetSection?.scrollIntoView({ behavior: 'smooth', block: 'start' });
+                        return;
+                    }
+
+                    sections.forEach(section => section.classList.remove('active'));
                     document.getElementById(`content-${tabId}`).classList.add('active');
                 });
             });
 
+            if (previewToggleButton) {
+                const updatePreviewButtonLabel = (isPreviewMode) => {
+                    previewToggleButton.textContent = isPreviewMode ? '返回分頁模式' : '預覽模式';
+                    previewToggleButton.setAttribute('aria-pressed', String(isPreviewMode));
+                };
+
+                updatePreviewButtonLabel(false);
+                if (previewBanner) {
+                    previewBanner.hidden = true;
+                }
+
+                previewToggleButton.addEventListener('click', () => {
+                    const isPreviewMode = document.body.classList.toggle('preview-mode');
+                    updatePreviewButtonLabel(isPreviewMode);
+                    if (previewBanner) {
+                        previewBanner.hidden = !isPreviewMode;
+                    }
+
+                    if (!isPreviewMode) {
+                        // 當離開預覽模式時，確保當前選取的分頁內容顯示
+                        const activeTab = document.querySelector('.nav-tab.active');
+                        const activeTabId = activeTab?.getAttribute('data-tab') || 'overview';
+
+                        sections.forEach(section => {
+                            if (section.id === `content-${activeTabId}`) {
+                                section.classList.add('active');
+                            } else {
+                                section.classList.remove('active');
+                            }
+                        });
+                    }
+                });
+            }
+
             // --- Gemini API 金鑰 (請留空，由 Canvas 提供) ---
             const apiKey = "";
             const genaiModel = "gemini-2.5-flash-preview-09-2025";
             const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${genaiModel}:generateContent?key=${apiKey}`;
 
             // --- 指數退避重試函式 ---
             async function fetchWithExponentialBackoff(url, payload, retries = 5, delay = 1000) {
                 for (let i = 0; i < retries; i++) {
                     try {
                         const response = await fetch(url, {
                             method: 'POST',
                             headers: { 'Content-Type': 'application/json' },
                             body: JSON.stringify(payload)
                         });
 
                         if (!response.ok) {
                             if (response.status === 429 || response.status >= 500) {
                                 // 觸發重試
                                 throw new Error(`Retryable error: ${response.status}`);
                             } else {
                                 // 不可重試的錯誤
                                 const errorResult = await response.json().catch(() => ({}));
                                 const errorText = errorResult.error?.message || `HTTP error! status: ${response.status}`;
                                 return { error: `API 請求失敗: ${errorText}` };
                             }
 
EOF
)
